def route_query(query: str) -> str:
    """
    Rule-based query routing function (simplified version of the one in agent.py)
    
    Args:
        query: User query
        
    Returns:
        Recommended search mode ("fast", "deep", "social", "academic", "finance")
    """
    # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –∑–∞–ø—Ä–æ—Å –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
    query_lower = query.lower()
    
    # 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏
    social_keywords = [
        "reddit", "twitter", "x.com", "vk.com", "habr", "—Å–æ–æ–±—â–µ—Å—Ç–≤–æ", 
        "–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏", "–ø–æ—Å—Ç—ã", "—Ç—Ä–µ–Ω–¥—ã", "–æ–±—Å—É–∂–¥–µ–Ω–∏—è", "–º–Ω–µ–Ω–∏—è", 
        "–Ω–æ–≤–æ—Å—Ç–∏ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞", "—Å–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å–µ—Ç—å"
    ]
    if any(keyword in query_lower for keyword in social_keywords):
        return "social"
    
    # 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏–µ —Ç–µ—Ä–º–∏–Ω—ã
    academic_keywords = [
        "–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ", "–Ω–∞—É—á–Ω—ã–π", "–ø—É–±–ª–∏–∫–∞—Ü–∏—è", "—Å—Ç–∞—Ç—å—è", "–∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏–π", 
        "—Ç–µ–æ—Ä–∏—è", "arxiv", "semantic scholar", "–Ω–∞—É—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞", "–¥–∏—Å—Å–µ—Ä—Ç–∞—Ü–∏—è",
        "—Ä–µ—Ü–µ–Ω–∑–∏—Ä—É–µ–º—ã–π", "–∂—É—Ä–Ω–∞–ª", "nlp", "—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä", "–Ω–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å"
    ]
    if any(keyword in query_lower for keyword in academic_keywords):
        return "academic"
    
    # 3. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ç–µ—Ä–º–∏–Ω—ã
    finance_keywords = [
        "–∞–∫—Ü–∏–∏", "—Ü–µ–Ω–∞", "—Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π", "–±–∏—Ä–∂–∞", "–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏", "—ç–∫–æ–Ω–æ–º–∏–∫–∞", 
        "–¥–æ—Ö–æ–¥", "yahoo finance", "bloomberg", "reuters", "—Ç—Ä–µ–π–¥–∏–Ω–≥", 
        "–ø–æ—Ä—Ç—Ñ–µ–ª—å", "–¥–∏–≤–∏–¥–µ–Ω–¥—ã", "–∫—É—Ä—Å", "–≤–∞–ª—é—Ç–∞", "–∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç"
    ]
    if any(keyword in query_lower for keyword in finance_keywords):
        return "finance"
    
    # 4. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–ª–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (deep)
    deep_keywords = [
        "–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å", "–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å", "–æ—Ü–µ–Ω–∏—Ç—å", "–∏–∑—É—á–∏—Ç—å", "–≤–ª–∏—è–Ω–∏–µ",
        "—Å—Ä–∞–≤–Ω–∏—Ç—å", "—Ä–∞–∑–æ–±—Ä–∞—Ç—å", "–æ–±—ä—è—Å–Ω–∏—Ç—å", "–ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å", "–≤–ª–∏—è–Ω–∏–µ",
        "–º–Ω–æ–≥–æ—à–∞–≥–æ–≤—ã–π", "–ø–æ–¥—Ä–æ–±–Ω—ã–π", "–∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π", "–≤—Å–µ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–π", "—Å—Ä–∞–≤–Ω–∏—Ç–µ",
        "–æ–±—ä—è—Å–Ω–∏—Ç–µ", "—Ä–∞–∑–±–µ—Ä–∏—Ç–µ", "–æ—Ü–µ–Ω–∏—Ç–µ", "–∏—Å—Å–ª–µ–¥—É–π—Ç–µ", "–ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ",
        "–≤–ª–∏—è–Ω–∏–µ", "—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å", "—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω", "–≤–ª–∏—è–µ—Ç", "–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å"
    ]
    if any(keyword in query_lower for keyword in deep_keywords):
        return "deep"
    
    # 5. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é - –±—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫
    return "fast"

def test_routing():
    """Test the rule-based routing functionality"""
    print("Testing rule-based routing functionality...")
    print("=" * 50)
    
    # Test queries for different modes
    test_cases = [
        ("–ö–∞–∫–æ–≤–∞ —Å—Ç–æ–ª–∏—Ü–∞ –§—Ä–∞–Ω—Ü–∏–∏?", "fast"),
        ("–†–∞—Å—Å–∫–∞–∂–∏ –º–Ω–µ –æ —Ñ–æ—Ç–æ—Å–∏–Ω—Ç–µ–∑–µ", "fast"),
        ("–ß—Ç–æ —Ç–∞–∫–æ–µ 15% –æ—Ç 200?", "fast"),
        ("–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –≤–ª–∏—è–Ω–∏–µ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ –Ω–∞ –º–∏—Ä–æ–≤—É—é —ç–∫–æ–Ω–æ–º–∏–∫—É", "deep"),
        ("–°—Ä–∞–≤–Ω–∏—Ç–µ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã –∫ –º–∞—à–∏–Ω–Ω–æ–º—É –æ–±—É—á–µ–Ω–∏—é", "deep"),
        ("–û–±—ä—è—Å–Ω–∏—Ç–µ —Ç–µ–æ—Ä–∏—é –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏", "deep"),
        ("–ö–∞–∫–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ –≤ —Å–æ–æ–±—â–µ—Å—Ç–≤–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ Python –Ω–∞ Reddit?", "social"),
        ("–ß—Ç–æ –æ–±—Å—É–∂–¥–∞—é—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ VK –ø–æ –ø–æ–≤–æ–¥—É –Ω–æ–≤–æ–π –∏–≥—Ä—ã?", "social"),
        ("–¢—Ä–µ–Ω–¥—ã –≤_twitter_ –ø–æ —Ç–µ–º–µ –∫–ª–∏–º–∞—Ç–∞", "social"),
        ("–ù–∞–π–¥–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ø–æ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–∞–º –≤ –æ–±–ª–∞—Å—Ç–∏ NLP", "academic"),
        ("–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–∞_–ª–∏ –Ω–∞—É—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –æ –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏—è—Ö –≤ —ç—Ç–æ–º –≥–æ–¥—É?", "academic"),
        ("–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –≤ arxiv –ø–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–º—É –∑—Ä–µ–Ω–∏—é", "academic"),
        ("–ö–∞–∫–æ–≤–∞ —Ç–µ–∫—É—â–∞—è —Ü–µ–Ω–∞ –∞–∫—Ü–∏–π Apple?", "finance"),
        ("–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –≤ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—É - –≤—ã–≥–æ–¥–Ω–æ –ª–∏ —ç—Ç–æ —Å–µ–π—á–∞—Å?", "finance"),
        ("–ö—É—Ä—Å –¥–æ–ª–ª–∞—Ä–∞ –∫ —Ä—É–±–ª—é —Å–µ–≥–æ–¥–Ω—è", "finance")
    ]
    
    passed = 0
    total = len(test_cases)
    
    for query, expected_mode in test_cases:
        selected_mode = route_query(query)
        result = "‚úì PASS" if selected_mode == expected_mode else "‚úó FAIL"
        print(f"  {query[:50]:<50} -> {selected_mode:<8} (expected: {expected_mode:<8}) {result}")
        if selected_mode == expected_mode:
            passed += 1
    
    print(f"\n=== SUMMARY ===")
    print(f"Passed: {passed}/{total}")
    print(f"Success rate: {passed/total*100:.1f}%")
    
    return passed == total

if __name__ == "__main__":
    success = test_routing()
    if success:
        print("\nüéâ All tests passed! The routing logic is working correctly.")
    else:
        print("\n‚ùå Some tests failed. The routing logic needs improvement.")